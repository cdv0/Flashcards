<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Modal Test Page</title>
  <link rel="stylesheet" href="../styles/main.css" />
</head>

<body>
  <h1>Modal Test Page</h1>

  <!-- Delete set test -->
  <div class="set-card">
    <p class="set-title">CECS 448 Midterm 2</p>
    <p class="set-meta">Section: CECS 448</p>

    <button
      class="delete-set-btn"
      data-set-name="CECS 448 Midterm 2"
      data-section-name="CECS 448"
    >
      Delete set
    </button>
  </div>

  <!-- Rename subset test (unchanged) -->
  <div class="set-card" style="margin-top: 2rem;">
    <p id="subsetLabel">Subset: Not confident</p>
    <button
      id="renameSubsetBtn"
      data-subset-name="Not confident"
      data-current-title="Not confident"
    >
      Rename subset
    </button>
  </div>

  <!-- Leave study warning test (NEW) -->
  <div class="set-card" style="margin-top: 2rem;">
    <p id="warningSubsetLabel">Subset: Not confident</p>
    <button
      id="leaveWarningBtn"
      data-subset-name="Not confident"
      data-set-title="CECS 448 Midterm 2"
    >
      Open warning modal
    </button>
  </div>

  <script type="module">
    import { openDeleteConfirmationModal } from "../scripts/openDeleteConfirmationModal.js";
    import { openRenameSubsetModal } from "../scripts/renameSubsetModal.js";
    import { openLeaveStudyWarningModal } from "../scripts/leaveStudyWarningModal.js";

    // Delete set test
    const deleteBtn = document.querySelector(".delete-set-btn");

    deleteBtn.addEventListener("click", () => {
      const setName = deleteBtn.dataset.setName;
      const sectionName = deleteBtn.dataset.sectionName;

      openDeleteConfirmationModal(setName, sectionName, () => {
        deleteBtn.closest(".set-card")?.remove();
      });
    });

    // Rename subset test (unchanged)
    const renameBtn = document.getElementById("renameSubsetBtn");
    const subsetLabel = document.getElementById("subsetLabel");

    renameBtn.addEventListener("click", () => {
      const subsetName = renameBtn.dataset.subsetName;
      const currentTitle = renameBtn.dataset.currentTitle;

      openRenameSubsetModal(subsetName, currentTitle, (newTitle) => {
        renameBtn.dataset.currentTitle = newTitle;
        subsetLabel.textContent = `Subset: ${newTitle}`;
      });
    });

    // Leave study warning test (NEW)
    const leaveWarningBtn = document.getElementById("leaveWarningBtn");
    const warningSubsetLabel = document.getElementById("warningSubsetLabel");

    leaveWarningBtn.addEventListener("click", () => {
      const subsetName = leaveWarningBtn.dataset.subsetName;
      const setTitle = leaveWarningBtn.dataset.setTitle;

      openLeaveStudyWarningModal(subsetName, setTitle, () => {
        // example behavior when "Leave" is confirmed
        warningSubsetLabel.textContent = `Left study session for ${setTitle}`;
      });
    });
  </script>
</body>
</html>